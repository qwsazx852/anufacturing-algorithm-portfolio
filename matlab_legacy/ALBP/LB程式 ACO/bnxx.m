clc
clear

n=1000

order=[1,883
2,317
3,23
4,23
5,23
6,23
7,23
8,23
9,23
10,395
11,303
13,27
14,25
14,26
14,36
16,32
17,24
17,28
17,38
17,44
18,30
18,34
19,29
19,39
19,41
20,33
20,43
21,35
21,37
21,40
21,42
22,31
23,47
23,48
23,49
23,50
23,51
23,52
24,395
25,395
26,395
27,184
28,45
29,67
32,62
32,65
32,69
34,53
34,59
34,68
36,60
37,57
40,63
41,54
41,61
42,55
43,58
44,46
44,56
44,64
44,66
45,265
46,265
47,395
48,80
49,78
51,70
51,83
52,79
53,524
54,790
58,72
58,81
60,74
61,71
61,75
61,76
61,84
63,73
63,82
69,77
70,882
71,395
72,184
73,319
74,319
75,85
75,93
76,98
77,90
78,86
80,85
81,89
81,91
81,94
82,87
82,92
82,97
83,88
84,95
84,96
85,675
86,675
87,265
88,790
89,102
89,104
89,108
90,99
90,105
92,110
93,107
94,100
94,106
97,101
98,103
98,109
99,808
100,790
101,303
102,114
103,111
103,112
103,119
103,120
103,126
104,123
104,125
104,128
104,129
107,113
107,116
107,122
107,124
108,118
109,117
109,121
109,127
110,115
110,130
111,675
112,601
113,395
114,184
115,184
116,142
116,145
117,139
118,144
118,148
119,131
123,141
123,150
124,133
124,137
124,149
127,134
128,135
128,143
128,146
128,147
129,140
129,151
130,132
130,136
130,138
131,317
132,395
133,164
133,165
135,157
135,161
135,401
137,153
137,156
139,159
144,152
144,158
144,160
145,163
148,155
150,154
151,162
152,265
153,317
154,319
155,168
155,169
155,181
156,172
156,176
158,180
159,174
159,179
160,173
161,171
162,166
162,170
162,175
163,167
165,177
165,178
166,265
167,184
168,303
169,191
169,193
170,187
170,198
170,199
171,189
172,471
173,185
173,186
173,188
173,194
173,195
174,182
175,183
175,196
177,197
179,200
179,201
180,190
180,192
182,675
183,808
184,205
184,206
184,207
184,208
184,209
184,210
184,211
184,212
184,213
184,214
184,215
184,216
184,217
184,218
184,224
185,230
186,229
190,223
192,204
193,202
193,220
193,228
194,222
195,227
196,219
196,221
197,226
198,203
200,225
202,675
203,808
204,317
205,395
209,246
209,388
210,232
211,239
211,247
214,231
214,245
216,243
218,241
218,244
219,248
223,235
223,236
227,233
228,234
228,240
229,237
229,242
230,238
231,808
232,265
233,601
234,395
235,395
237,259
237,260
239,258
241,250
241,262
242,261
242,684
243,251
243,257
244,249
244,264
245,253
246,254
246,256
246,263
247,252
248,255
249,265
250,882
251,319
252,303
253,276
253,284
255,267
255,281
256,272
256,280
256,285
258,274
259,270
260,278
260,282
260,283
261,266
261,279
261,287
262,269
262,275
262,277
262,286
263,273
264,268
264,271
265,288
265,289
265,290
265,291
265,292
265,293
265,294
265,295
265,296
265,297
265,298
265,299
265,314
265,316
266,317
267,790
268,303
271,300
271,308
271,311
272,302
273,301
273,307
274,309
274,315
275,310
276,305
276,312
278,304
282,306
284,313
288,882
289,882
291,336
292,326
292,335
294,329
295,325
296,337
300,317
301,395
302,319
303,320
303,321
303,322
303,323
303,330
304,318
304,333
307,327
307,332
308,328
310,331
311,324
311,455
312,334
317,338
317,339
317,340
317,341
318,756
319,342
319,343
319,344
319,345
319,346
319,347
319,358
320,348
321,356
323,355
325,357
326,353
327,349
327,359
328,350
330,360
333,352
336,351
336,354
339,369
340,371
342,362
344,361
345,370
346,373
347,365
349,363
350,372
350,375
352,368
353,374
356,366
356,376
357,367
358,364
361,601
362,790
363,377
363,389
364,378
364,379
365,383
365,385
366,380
366,388
366,391
367,387
370,384
372,386
372,390
373,392
374,382
376,381
377,395
378,395
379,394
379,398
379,401
380,399
381,407
381,408
381,411
383,405
384,400
384,410
386,403
387,397
387,402
389,406
389,409
390,412
391,393
391,404
392,396
393,601
394,756
395,415
395,416
395,417
395,418
397,431
398,419
398,426
398,429
398,434
399,414
399,430
400,413
400,428
400,714
402,421
402,423
402,425
403,420
404,433
408,424
408,436
409,422
410,427
410,435
412,432
413,675
414,883
415,439
416,443
417,450
419,447
420,449
420,452
421,437
421,445
422,454
425,440
428,451
430,438
430,448
432,444
432,446
432,453
433,442
434,441
437,883
438,601
439,524
440,458
440,465
443,464
443,587
445,457
445,460
445,467
445,468
446,466
446,469
447,459
447,463
451,456
453,462
454,455
454,461
455,756
456,482
458,470
458,476
459,483
459,484
460,491
462,490
463,987
465,471
465,473
465,475
466,474
466,481
466,486
467,478
467,480
467,488
468,472
468,477
468,479
468,485
469,487
469,489
470,524
471,524
472,493
474,495
474,500
476,501
478,494
480,498
480,499
488,496
489,869
490,492
491,497
492,808
493,756
494,504
494,505
494,506
494,509
495,502
495,503
495,515
498,511
498,512
498,517
498,520
498,521
499,508
499,513
500,507
500,516
500,519
500,522
501,510
501,514
501,518
502,524
503,526
504,540
505,528
505,532
505,538
507,530
507,534
507,539
508,541
509,533
510,525
512,537
515,535
517,531
518,523
518,536
520,529
522,527
523,808
524,546
524,547
524,548
524,549
524,550
524,551
524,552
525,554
525,564
526,566
527,565
528,553
529,544
530,545
531,560
533,543
534,556
534,559
536,558
537,561
537,562
537,563
538,557
541,542
541,555
542,675
543,808
544,882
545,756
547,570
547,572
549,567
550,566
550,579
551,576
553,574
554,577
554,578
555,573
556,568
556,575
558,569
564,571
567,600
568,597
569,583
570,580
570,590
570,592
571,585
571,587
571,591
572,595
572,596
573,589
573,593
574,584
574,594
575,586
576,582
576,598
577,588
579,581
579,599
580,601
581,607
583,615
587,602
587,603
587,614
588,610
588,770
589,609
591,612
593,613
594,606
594,978
597,604
597,608
599,605
599,611
599,616
601,618
601,619
601,620
601,621
601,622
601,623
602,631
604,624
604,632
605,629
606,630
607,617
607,628
609,626
614,625
616,627
617,808
618,653
619,640
619,649
621,641
622,633
622,648
623,634
623,637
623,644
624,638
624,645
625,686
627,635
627,643
627,647
628,652
629,642
629,651
630,650
631,639
631,646
631,786
632,636
633,882
634,658
636,671
638,655
638,668
639,660
640,656
640,664
640,666
640,667
640,673
643,657
643,661
644,654
644,659
645,670
646,669
646,672
648,662
648,663
650,665
653,674
654,675
655,677
656,679
658,685
661,681
663,676
663,680
663,688
666,678
669,689
670,684
671,683
672,682
672,687
674,686
675,690
675,691
675,692
675,693
675,694
675,695
675,696
675,706
675,710
676,707
676,713
677,701
677,709
680,704
680,711
682,705
683,702
684,700
685,714
686,699
686,708
687,703
687,712
689,697
689,698
690,720
690,725
693,723
697,730
698,719
698,727
698,728
700,729
700,733
701,735
703,716
703,732
704,722
705,721
706,726
707,717
709,734
710,718
711,715
712,731
714,724
715,742
715,745
716,740
716,746
717,749
718,751
721,755
722,739
723,736
723,747
723,750
723,754
724,743
725,752
726,753
727,738
728,737
732,741
733,748
734,744
736,756
739,767
739,768
741,762
741,763
743,759
746,757
746,769
748,764
750,765
751,760
751,770
752,758
752,761
753,766
753,772
754,771
756,773
756,774
756,775
756,776
756,777
756,778
756,779
756,780
756,782
756,788
765,785
765,787
767,783
768,786
769,784
772,781
774,806
774,807
775,791
775,798
775,800
775,803
776,794
776,795
777,796
777,799
778,805
779,861
780,793
780,804
781,790
782,789
782,802
784,797
784,801
788,792
789,808
790,810
790,811
790,812
790,813
790,814
790,815
791,816
792,832
795,817
796,829
797,818
797,820
799,833
800,822
801,830
802,821
802,824
802,826
802,827
804,825
805,823
806,809
806,819
806,828
807,831
808,834
808,835
808,836
808,837
809,882
816,838
816,846
817,845
818,843
818,844
820,842
822,840
827,841
831,839
831,847
835,858
836,849
837,851
837,856
838,857
839,852
839,861
841,850
841,864
842,853
842,862
843,848
843,863
844,860
845,854
845,855
846,859
849,869
851,876
851,880
852,871
853,875
855,866
855,867
856,865
857,874
858,873
858,879
859,872
860,878
862,877
864,868
864,870
864,881
865,882
866,883
867,887
868,894
869,895
872,884
873,886
873,891
873,893
875,896
876,888
876,892
877,885
877,890
878,889
882,897
882,898
882,899
882,900
882,901
882,902
882,903
882,904
882,905
882,906
882,907
883,908
883,909
883,910
883,911
883,912
883,913
883,914
883,915
883,916
883,917
883,918
883,919
883,920
883,921
883,922
887,923
889,927
891,924
893,926
894,925
900,936
904,940
905,941
908,938
912,928
912,930
916,942
917,934
917,937
918,939
922,932
923,931
923,943
926,929
926,935
927,933
928,948
929,949
931,947
937,945
937,954
938,953
939,944
939,946
939,951
939,952
942,950
944,958
944,959
945,956
946,967
947,962
948,961
948,969
949,955
949,960
950,964
951,970
952,963
952,968
954,957
954,965
954,966
955,972
955,975
957,971
957,980
958,974
958,978
961,973
962,985
964,976
965,983
966,979
966,984
968,981
969,982
970,977
971,991
973,997
973,998
974,988
974,1000
975,992
977,993
978,986
978,987
978,996
981,989
981,994
982,995
983,999
985,990];
CA=cell(n,1);
bn=[];
for i=1:n
%     i
    if sum(order(:,1)==i) ~= 0
        ww=[order(order(:,1)==i,2)' 10000];
        xx=[order(order(:,1)==i,2)' order(order(:,1)==ww(1),2)'];
        while sum(ww) ~= 10000
            ww=[ww(1:end-1) order(order(:,1)==ww(1),2)' ww(end)];
            ww(1)=[];
            ww=unique(ww);
            xx=[xx order(order(:,1)==ww(1),2)'];
            xx=unique(xx);
        end
        bn(i)=nnz(xx);
        CA{i,1}=xx;
    else
        bn(i)= 0;
    end
end

Or=zeros(n);
for i=1:n
    for j=1:nnz(CA{i})
        Or(i,CA{i}(j))=1;
    end
end
bn=[];
for j =1:length(Or)
bn=[bn,length(find(Or(j,:)==1))]

end