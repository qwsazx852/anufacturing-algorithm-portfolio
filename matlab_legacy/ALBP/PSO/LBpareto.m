clc
clear

r=[0.1,0.8,0.1]; %¨Mµ¦°¾¦n
%% Kilbridge
% SS0=[-0.400000000000000,38,28;-0.400000000000000,36,29;16.3854482130831,39,27;20.6748565129653,39,25;16.4714263837233,37,27;16.3854482130831,42,25;22.8589559730373,48,24;16.3854482130831,35,34;26.1072586546543,33,29;17.3896583817983,36,28;-0.400000000000000,45,26;18.6650467473746,35,33;21.9010710812958,34,33;-0.400000000000000,42,27;25.9734212304143,39,23;-0.400000000000000,49,25;20.9474399023484,35,31;24.4912877537624,37,25;25.9487647216233,45,24;31.0250474556986,36,25];
% SS0=[-0.400000000000000,38,28,1,11,2,12,8,7,13,3,15,18,16,19,5,9,23,4,20,37,14,24,17,27,39,25,43,6,32,26,33,36,21,29,10,22,30,35,28,31,34,38,40,41,42,45,44;-0.400000000000000,36,29,1,12,7,3,11,13,2,15,23,8,16,18,19,14,24,4,37,5,9,17,20,39,27,25,6,33,26,43,32,36,21,30,29,22,10,34,31,28,35,38,40,41,42,45,44;16.3854482130831,39,27,11,12,13,15,1,2,7,8,14,18,31,24,3,17,16,4,19,6,27,37,23,33,35,43,20,36,5,10,21,22,9,28,25,26,32,34,38,29,30,39,40,41,42,45,44;20.6748565129653,39,25,12,1,11,13,2,8,15,3,7,39,24,18,14,37,16,19,4,17,25,20,43,6,27,5,10,32,29,30,23,33,21,36,9,26,34,35,22,31,28,38,40,41,42,44,45;16.4714263837233,37,27,12,2,11,13,1,7,8,14,31,15,18,24,17,37,3,16,19,4,6,27,23,5,33,36,10,29,43,30,20,21,9,25,22,28,39,34,35,26,38,32,40,41,42,45,44;16.3854482130831,42,25,11,12,13,1,15,2,7,8,14,31,18,24,3,37,4,16,19,17,27,6,23,5,33,36,10,20,30,29,43,21,9,22,28,25,35,34,26,38,39,40,32,41,42,45,44;22.8589559730373,48,24,11,12,13,1,2,15,8,7,37,14,25,17,18,3,24,5,16,19,32,4,30,26,23,9,20,6,27,33,29,39,43,21,34,22,35,36,28,10,38,40,31,41,42,45,44;16.3854482130831,35,34,1,12,7,11,2,13,8,14,15,31,18,24,17,3,16,37,19,4,27,6,23,5,10,33,36,43,29,30,20,21,22,28,9,25,26,39,32,35,34,38,40,41,42,45,44;26.1072586546543,33,29,2,12,1,11,13,15,23,7,3,8,37,14,30,4,24,16,25,17,29,18,19,43,20,31,39,27,6,5,21,33,10,22,32,36,26,28,9,35,34,38,40,41,42,44,45;17.3896583817983,36,28,2,12,1,11,13,7,8,14,31,15,18,24,17,37,3,16,19,4,6,27,23,5,33,36,10,29,43,30,20,21,9,25,22,32,26,28,35,34,39,38,40,41,42,44,45;-0.400000000000000,45,26,12,11,13,15,2,1,16,3,5,8,7,18,19,20,37,14,39,17,27,4,24,23,9,25,43,6,29,26,33,21,36,31,30,22,32,35,28,10,34,38,40,41,42,45,44;18.6650467473746,35,33,2,12,1,4,11,7,8,39,13,15,3,14,6,37,10,16,18,5,23,19,25,17,9,29,20,30,27,24,43,21,33,26,22,35,36,31,34,28,38,32,40,41,42,45,44;21.9010710812958,34,33,12,2,4,11,13,15,1,6,8,16,18,7,14,37,19,17,20,43,25,24,21,22,3,10,23,5,27,33,29,26,32,35,36,39,31,34,28,38,40,30,9,41,42,44,45;-0.400000000000000,42,27,1,11,3,12,13,2,15,18,16,8,7,5,19,37,14,24,17,23,9,20,27,4,39,32,33,43,6,25,36,26,21,22,30,29,10,35,34,28,31,38,40,41,42,45,44;25.9734212304143,39,23,39,12,1,11,13,15,2,18,8,24,7,14,23,16,37,31,3,17,4,6,10,19,20,43,27,21,33,29,22,32,5,34,35,9,25,26,36,28,30,38,40,41,42,44,45;-0.400000000000000,49,25,12,1,11,13,2,15,3,5,16,7,18,8,19,14,37,24,32,17,9,27,39,23,4,25,43,20,6,26,21,33,36,34,35,22,28,31,10,38,30,40,29,41,42,45,44;20.9474399023484,35,31,12,11,39,2,1,13,7,37,15,43,16,18,8,23,19,4,3,14,6,25,29,5,17,9,30,20,27,26,24,21,33,22,10,28,35,34,31,36,38,32,40,41,42,44,45;24.4912877537624,37,25,12,11,13,15,2,8,1,7,14,18,16,32,17,3,24,27,4,19,37,25,6,20,21,29,22,10,5,30,39,26,23,33,34,35,31,28,36,38,9,40,41,42,43,44,45;25.9487647216233,45,24,11,39,12,1,13,15,2,18,16,4,6,8,3,24,7,14,19,31,5,9,20,30,23,21,32,22,29,17,27,28,25,33,26,34,35,36,37,10,38,43,40,41,42,44,45;31.0250474556986,36,25,12,11,13,15,2,18,1,8,24,7,14,23,16,37,31,3,17,4,6,10,19,20,43,27,21,33,29,22,32,5,34,35,9,25,28,26,39,36,38,40,30,41,42,44,45];
%% Wee-Mag
% SS0=[3.35818485800000,60,50;3.36133871500000,61,47;3.35818485800000,67,45;3.37706766900000,69,41;3.36133871500000,58,54;3.68774820200000,57,51;3.59244623200000,63,46;3.35818485800000,74,42;3.72467448600000,55,54;3.36133871500000,59,52;4.21262173700000,73,40;3.36763834300000,59,50;3.38334055800000,60,49;3.35818485800000,56,55;3.36448987400000,65,46;4.36564387400000,54,55;4.15194119000000,60,48;3.35818485800000,64,47;3.61721443700000,82,40;3.62301962400000,58,51;3.36448987400000,72,43;3.60557829200000,68,43;3.35818485800000,69,44;3.75706108000000,58,49;3.89239322000000,66,45;3.96270833300000,54,61;3.35818485800000,63,48];
SS0=[1.09744187653921e-06	94.8430000000000	0.00737100000000000
5.94649013988863e-05	117.852500000000	0.00864350000000000
5.38235158609308e-06	117.852500000000	0.00737100000000000
8.22358156696558e-06	78.4848000000000	0
6.68667863322395e-06	72.9818000000000	0
4.05523800466070e-05	75.9836000000000	0
3.71961160903328e-06	86.4928000000000	0
0.00162447250281435	89.9988000000000	0
9.93416444659702e-06	85.9958000000000	0
5.53623019179228e-05	83.9916000000000	0
0.000436699159133288	77.9898000000000	0
0.00286786964175665	70.4806000000000	0
0.000155611881479996	75.9836000000000	0
0.000335145924901242	70.4806000000000	0
2.21322426243206e-05	70.4806000000000	0
8.77740081464082e-05	73.9923000000000	0
0.000416713002331705	70.4806000000000	0
0.000121405179486815	70.4806000000000	0
6.53219459686978e-05	92.0056000000000	0
3.47117977476289e-07	100.835500000000	0.00737100000000000
4.22285694072787e-05	118.855500000000	0.00737100000000000
1.40208380021472e-07	99.8343000000000	0.0152605000000000
2.51234382523251e-08	100.835500000000	0.00864350000000000
1.61631039830864e-08	99.8343000000000	0.00838900000000000
5.28855220874663e-05	120.858000000000	0.0186291000000000
5.81754137265602e-09	70.4806000000000	0]
%%
x=SS0(:,1);
y=SS0(:,2);
z=SS0(:,3);
plot3(x,y,z,'.','MarkerSize',20)
xlabel('f3','FontName','Times New Roman')
ylabel('f1','FontName','Times New Roman')
zlabel('f2','FontName','Times New Roman')
grid on

f=[];
% for i=1:3
%     if i~=3
%     f(i)=max(SS0(:,i))+((1-r(i))*(max(SS0(:,i))-min(SS0(:,i))))
%     else
%     f(i)=min(SS0(:,i))+((1-r(i))*(max(SS0(:,i))-min(SS0(:,i))))
%     end
% end
for i=1:3
    f(i)=max(SS0(:,i))+((1-r(i))*(max(SS0(:,i))-min(SS0(:,i))))  
end
f
f1=repmat(f,size(SS0,1),1)
r1=repmat(r,size(SS0,1),1)
d=r1.*((f1-SS0).^2)
d1=[];
for i1=1:size(SS0,1)
    d1=[d1;i1 sum(d(i1,:))^(1/2)]
end
d1;
a=d1(d1(:,2)==min(d1(:,2)),:)
SS0(a(1),:)